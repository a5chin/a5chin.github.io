<!DOCTYPE html>
<html lang="ja">
	<head>
		<title>a5chin's portfolio</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

		<link rel="stylesheet" href="../css/animate.css">		
		<link rel="stylesheet" href="../css/icomoon.css">
		<link rel="stylesheet" href="../css/style.css">

		<!-- Icon -->
		<link rel="shortcut icon" type="image/svg+xml" href="../images/po.svg">
		<link rel="icon" type="image/svg+xml" href="../images/po.svg" />

		<!-- Chart.js -->
		<script src="../js/chart.js"></script>
		<script src="../js/chartjs-plugin-colorschemes.min.js"></script>
	</head>
	<body>
		<!-- Start Nav Section -->
		<nav id="navbar-2" class="navbar-2">
			<ul class="nav-menu">
				<li>
				<a data-scroll="home" href="../index.html#home" class="dot">
					<span>Home</span>
				</a>
				</li>
				<li>
				<a data-scroll="careers" href="../index.html#careers" class="dot">
					<span>Careers</span>
				</a>
				</li>
				<li>
				<a data-scroll="work" href="../index.html#work" class="dot active">
					<span>Works</span>
				</a>
				</li>
				<li>
				<a data-scroll="who" href="../index.html#who" class="dot">
					<span>Who</span>
				</a>
				</li>
				<li>
				<a href="../index.html#contact" class="dot">
					<span>Contact</span>
				</a>
				</li>
			</ul>
		</nav>
		<!-- End Nav Section -->
		<!-- Start Home Section -->
		<section id="home" class="hero-wrap js-fullheight" style="background-image: url(../images/melanoma.png);" data-stellar-background-ratio="0.5">
      <div class="overlay"></div>
      <div class="container">
        <div class="row no-gutters slider-text js-fullheight align-items-center justify-content-center">
          <div class="col-lg-7 ftco-animate d-flex align-items-center">
          	<div class="text text-center">
	            <h1 class="bread" style="font-size: 3rem;">Classification of melanoma and lentigo by CNN</h1>
	            <p class="breadcrumbs"><span class="mr-2"><a href="index.html">Home</a></span> <span>About me</span></p>
            </div>
          </div>
        </div>
      </div>
    </section>
		<!-- End Home Section -->
		<!-- Start Main Section -->
		<section class="ftco-section work-single ftco-no-pt ftco-no-pb">
			<div class="container">
				<h2 class="text-center ftco-animate" style="padding-top: 3rem;">データセットについて</h2>
				<div class="row mx-auto py-5 ftco-animate">
					<div class="col-md-6" style="background-color: silver;">
						<canvas id="dataset"></canvas>
						<script>
							var ctx = document.getElementById('dataset').getContext('2d');
							var chart = new Chart(ctx, {
								type: 'bar',
								data: {
									labels: ['元のデータセット', 'オーギュメンテーション後'],
									datasets: [
										{
											label: 'benign',
											data: [32542, 584],
											backgroundColor: ['#ed7d31']
										},
										{
											label: 'malignant',
											data: [584, 584],
											backgroundColor: ['#5b9bd5']
										}
									]
								},
						
								options: {
									responsive: true,
									plugins: {
										legend: {
											position: 'top',
										},
										title: {
											display: true,
											text: '実験で使用するデータセット'
										},
									},
									scales: {
										y: {
											ticks: {
												// Include a dollar sign in the ticks
												callback: function(value, index, values) {
													return value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',') + '枚';
												}
											},
											grid: {
												color: 'grey'
											}
										},
										x: {
											grid: {
												color: 'grey'
											}
										}
									}
								}
							});
						</script>
					</div>
					<div class="col-md-6 my-auto py-5 text pl-md-5">
						<p><a href="https://www.kaggle.com/">Kaggle</a>でダウンロードしたデータセットでは，良性が32542枚，悪性が584枚でとても偏りが多いものとなっていて，過学習の原因となってしまいます．そのため，メラノーマのデータ数に合わせて学習を進めていきます．</p>
					</div>
				</div>
				<div class="row py-3 mx-auto ftco-animate">
					<div class="col-md-8" style="background-color: silver;">
						<div class="row mx-auto">
							<canvas id="age" style="height: 15rem;"></canvas>
							<script>
								var ctx = document.getElementById('age').getContext('2d');
								var chart = new Chart(ctx, {
									type: 'line',
									data: {
										labels: [...Array(17)].map((_, i) => i * 5 + 10),
										datasets: [
											{
												label: 'benign',
												data: [0.0523496,0.4003203,1.9985219,4.7053027,7.1872883,8.6992671,10.9379812,13.5862536,12.9857732,11.5784936,09.7770524,7.5660528,5.8816284,2.8299563,1.1794051,0.4311141,0.1970807],
												borderColor: '#ed7d31',
												tension: 0.5,
												borderWidth: 4,
												radius: 0,
											},
											{
												label: 'malignant',
												data: [0,0.3424658,1.0273973,2.739726,4.109589,4.2808219,4.109589,9.2465753,9.0753425,10.9589041,11.130137,11.9863014,09.9315068,10.6164384,6.1643836,1.5410959,2.739726],
												borderColor: '#5b9bd5',
												tension: 0.3,
												borderWidth: 4,
												radius: 0,
											}
										]
									},
									options: {
										responsive: true,
										interaction: {
											intersect: false
										},
										plugins: {
	
											title: {
												display: true,
												text: '年齢における相対分布'
											},
										},
										scales: {
											y: {
												ticks: {
													callback: function(value, index, values) {
														return value.toString() + '%';
													}
												},
												grid: {
													color: 'grey'
												}
											},
											x: {
												type: 'linear',
												grid: {
													color: 'grey'
												}
											}
										}
									},
								});
							</script>
						</div>
						<div class="row mx-auto">
							<div class="col-md-4">
								<canvas id="sex" style="height: 15rem;"></canvas>
								<script>
									var ctx = document.getElementById('sex').getContext('2d');
									var chart = new Chart(ctx, {
										type: 'bar',
										data: {
											labels: ['male', 'female'],
											datasets: [
												{
													label: 'benign',
													data: [51.5416872, 48.4583128],
													backgroundColor: ['#ed7d31']
												},
												{
													label: 'malignant',
													data: [62.3287671, 37.6712329],
													backgroundColor: ['#5b9bd5']
												}
											]
										},
								
										options: {
											responsive: true,
											maintainAspectRatio: false,

											plugins: {
												legend: {
													position: 'top',
												},
												title: {
													display: true,
													text: '男女の比率'
												},
											},
											scales: {
												y: {
													min: 30,
													ticks: {
														callback: function(value, index, values) {
															return value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',') + '%';
														}
													},
													grid: {
														color: 'grey'
													}
												},
												x: {
													grid: {
														color: 'grey'
													}
												}
											}
										}
									});
								</script>
							</div>
							<div class="col-md-8">
								<canvas id="site" style="height: 15rem;"></canvas>
								<script>
									var ctx = document.getElementById('site').getContext('2d');
									var chart = new Chart(ctx, {
										type: 'bar',
										data: {
											labels: ['oral/genital', 'palms/soles', 'head/neck', 'upper', 'lower', 'torso'],
											datasets: [
												{
													label: 'benign',
													data: [35.0083208, 57.0574195, 30.1744243, 44.0744461, 54.5626379, 53.6805276],
													backgroundColor: ['#ed7d31']
												},
												{
													label: 'malignant',
													data: [64.9916792, 42.9425805, 69.8255757, 55.9255539, 45.4373621, 46.3194724],
													backgroundColor: ['#5b9bd5']
												}
											]
										},
								
										options: {
											responsive: true,
											maintainAspectRatio: false,

											plugins: {
												legend: {
													position: 'top',
												},
												title: {
													display: true,
													text: '部位の分布'
												},
											},
											scales: {
												y: {
													min: 20,
													ticks: {
														callback: function(value, index, values) {
															return value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',') + '%';
														}
													},
													grid: {
														color: 'grey'
													}
												},
												x: {
													grid: {
														color: 'grey'
													}
												}
											}
										}
									});
								</script>
							</div>
						</div>
					</div>
					<div class="col-md-4 my-auto text p-md-5">
						<p>データセットに付属しているメタデータは図の様になっており，以下の事が読み取れます．</p>
						<ul>
							<li>年齢
								<ul>
									<li>高齢者の方がメラノーマの確率が高くなる</li>
									<li>ガンは高齢者の方が罹患しやすい</li>
								</ul>
							</li>
							<li>性別
								<ul>
									<li>女性に比べて男性の方が罹患しやすい</li>
								</ul>
							</li>
							<li>部位
								<ul>
									<li>粘膜の部分や頭部のものはメラノーマの割合が極端に高い</li>
									<li>掌，足の裏，下半身や胴体に出来たものは良性のものが多い</li>
								</ul>
							</li>
						</ul>
					</div>
				</div>
				<h2 class="text-center ftco-animate" style="padding-top: 3rem;">ROIの抽出</h2>
				<div class="row py-5 ftco-animate">
					<div class="col-md-4 offset-md-2 d-flex align-items-stretch">
						<div class="img w-100" style="background-image: url(../images/roi_success.png);"></div>
					</div>
					<div class="col-md-4 text pl-md-5">
						<p">実験で用いる<a href="https://kaggle.com">Kaggle</a>からダウンロードした画像は</p>
						<ul>
							<li>ROIが中央</li>
							<li>ROIが1つ</li>
							<li>体毛が写っている</li>
						</ul>
						という様な写真となっています．
					</div>
				</div>
				<div class="row py-5 ftco-animate">
					<div class="col-md-4 offset-md-2 d-flex align-items-stretch">
						<div class="img w-100" style="background-image: url(../images/roi.png);"></div>
					</div>
					<div class="col-md-4 text pl-md-5">
						<p>実際にメラノーマか否かを判断するのに必要な領域は，肌を含まない茶色に変色した部分です．</p>
						<p>そのため，ネットワークを用いた学習時には，OpenCVの <code>findContours()</code> を使用して対象となる領域を抽出し，その他の必要とならない皮膚の部分を黒く塗りつぶすことで過学習を抑制した学習を進めることができます．</p>
					</div>
				</div>
				<div class="row py-5 ftco-animate">
					<div class="col-md-4 offset-md-2 d-flex align-items-stretch">
						<div class="img w-100" style="background-image: url(../images/roi_failure.png);"></div>
					</div>
					<div class="col-md-4 text pl-md-5">
						<p>しかし，抽出後の画像の中にはいくつか想定をしていない抽出をされた画像も存在していました．全てを確認した訳ではありませんが，3割程度が想定していない抽出のされ方をしていました．これが，学習の精度を妨げる要因となり得るため</p>
						<ul>
							<li>今回採用したものとは異なる関数を用いる</li>
							<li><code>findContours()</code>を医用に最適化する</li>
						</ul>
						<p>等のアルゴリズムの改善が求められ，それが今後の課題の1つとなります．</p>
					</div>
				</div>
				<h2 class="text-center ftco-animate" style="padding-top: 3rem;">ResNet18を用いた学習</h2>
				<div class="row py-5 ftco-animate">
					<div class="col-md-6 d-flex align-items-stretch">
						<div class="img w-100" style="background-image: url(../images/res18.png);"></div>
					</div>
					<div class="col-md-6 my-auto">
						<canvas id="resnet" class="col-md-12" style="background-color: silver; height: 20rem; margin-top: 1rem;"></canvas>
						<script>
							var ctx = document.getElementById('resnet').getContext('2d');
							var chart = new Chart(ctx, {
								type: 'line',
								data: {
									labels: [...Array(200)].map((_, i) => i + 1),
									datasets: [
										{
											label: 'train_meta',
											data: [54.3269217,57.9326928,60.6971145,64.0625,66.4663434,66.2259638,66.3461566,66.4663434,67.5480783,68.8701928,70.9134638,73.6778855,73.5576928,74.0384638,73.7980783,73.4375,75.1201928,74.2788434,72.4759638,74.5192289,75.,74.7596145,74.7596145,75.8413434,76.2019217,75.3605783,75.4807711,75.1201928,75.2403855,75.3605783,75.9615362,75.2403855,78.0048072,76.8028855,76.5625,77.6442289,77.2836566,77.4038434,78.2451928,75.8413434,76.8028855,76.9230783,77.6442289,78.3653855,78.2451928,76.8028855,78.0048072,79.8076928,78.2451928,77.4038434,76.6826928,78.2451928,78.9663434,79.5673072,78.8461566,79.3269217,79.8076928,80.1682711,79.0865362,75.4807711,77.4038434,79.8076928,78.6057711,79.3269217,80.2884638,79.2067289,80.0480783,80.0480783,79.4471145,78.125,79.2067289,80.4086566,80.2884638,79.2067289,81.9711566,81.25,81.4903855,81.1298072,80.5288434,80.6490362,80.0480783,78.9663434,80.7692289,80.2884638,82.5721145,81.7307711,82.2115362,81.9711566,82.2115362,79.8076928,79.3269217,80.8894217,79.8076928,81.8509638,82.6923072,81.4903855,82.0913434,81.0096145,81.9711566,81.25,80.2884638,82.8125,80.6490362,83.8942289,84.0144217,82.8125,82.9326928,84.0144217,81.4903855,81.0096145,81.4903855,81.1298072,83.6538434,83.2932711,83.2932711,83.5336566,84.2548072,84.4951928,82.6923072,81.8509638,81.3701928,81.4903855,81.6105783,82.8125,83.8942289,85.0961566,83.4134638,84.8557711,84.7355783,80.5288434,82.2115362,82.9326928,82.2115362,85.2163434,84.0144217,85.3365362,84.375,84.2548072,83.1730783,83.5336566,79.4471145,84.7355783,84.4951928,84.1346145,85.4567289,86.8990362,84.8557711,84.8557711,84.7355783,83.4134638,83.2932711,82.2115362,84.1346145,85.6971145,87.0192289,86.0576928,87.2596145,86.5384638,84.4951928,81.9711566,81.9711566,83.6538434,85.9375,87.1394217,87.2596145,86.0576928,86.1778855,86.2980783,85.0961566,83.2932711,83.0528855,86.0576928,84.9759638,86.6586566,87.1394217,87.2596145,86.0576928,86.5384638,86.1778855,85.0961566,85.0961566,84.2548072,85.0961566,86.1778855,87.2596145,87.0192289,86.4182711,87.7403855,85.9375,83.7740362,83.6538434,85.4567289,85.5769217,85.0961566,87.5,89.0625,88.5817289,86.4182711,85.3365362,84.6153855],
											borderColor: '#4f81bd',
											tension: 0.3,
											borderWidth: 4,
											radius: 0,
										},
										{
											label: 'train',
											data: [56.4903855,65.0240362,70.4326928,74.1586566,75.2403855,73.3173072,76.0817289,77.2836566,74.3990362,74.3990362,71.875,74.8798072,75.8413434,78.4855783,79.0865362,78.8461566,78.4855783,79.4471145,77.6442289,78.6057711,77.2836566,78.6057711,79.4471145,78.125,80.0480783,81.25,80.5288434,79.9278855,78.6057711,78.7259638,79.0865362,78.2451928,80.0480783,80.5288434,81.4903855,82.0913434,81.4903855,81.0096145,80.6490362,79.8076928,77.4038434,78.125,80.2884638,81.3701928,82.0913434,82.3317289,81.1298072,81.25,81.25,81.8509638,80.4086566,79.2067289,81.1298072,82.0913434,83.5336566,84.4951928,81.4903855,80.6490362,81.1298072,81.7307711,81.0096145,82.2115362,80.4086566,82.4519217,83.8942289,84.2548072,83.1730783,83.6538434,83.0528855,81.6105783,80.8894217,81.7307711,82.6923072,82.2115362,84.1346145,86.0576928,85.2163434,83.1730783,83.1730783,82.6923072,81.3701928,81.25,82.4519217,86.0576928,84.6153855,84.7355783,85.0961566,84.4951928,85.0961566,83.1730783,83.4134638,81.9711566,85.3365362,84.8557711,86.1778855,85.8173072,86.4182711,86.6586566,84.8557711,82.3317289,83.4134638,83.2932711,83.0528855,85.6971145,86.5384638,88.3413434,86.1778855,84.9759638,85.0961566,82.8125,84.0144217,82.8125,84.2548072,86.5384638,85.8173072,85.5769217,87.7403855,86.5384638,84.8557711,82.9326928,82.4519217,84.7355783,84.1346145,87.1394217,88.9423072,86.7788434,88.2211566,84.8557711,85.5769217,85.2163434,84.7355783,86.0576928,87.7403855,87.8605783,89.0625,89.3028855,88.4615362,87.1394217,87.3798072,82.5721145,83.8942289,84.0144217,86.6586566,87.7403855,89.1826928,87.9807711,87.2596145,87.0192289,86.5384638,84.2548072,85.0961566,85.5769217,85.3365362,86.5384638,87.0192289,89.1826928,89.3028855,87.6201928,87.3798072,85.9375,86.5384638,85.6971145,86.6586566,87.7403855,90.3846145,88.8221145,90.0240362,89.4230783,88.7019217,86.8990362,86.6586566,86.5384638,87.6201928,88.5817289,89.4230783,90.7451928,91.1057711,90.5048072,88.5817289,86.8990362,85.8173072,86.0576928,87.8605783,89.1826928,88.9423072,90.1442289,90.8653855,89.4230783,90.2644217,85.4567289,87.7403855,87.3798072,87.7403855,90.1442289,89.6634638,91.3461566,90.9855783,90.625,88.1009638,87.0192289],
											borderColor: '#c0504d',
											tension: 0.1,
											borderWidth: 4,
											radius: 0,
										},
										{
											label: 'val_meta',
											data: [54.1666687,58.6805582,63.1944418,66.3194418,65.9722209,65.9722209,68.0555582,68.75,68.75,69.0972209,71.5277791,71.875,72.5694418,73.2638896,73.9583313,73.6111104,73.9583313,72.9166687,72.5694418,74.6527791,73.6111104,75.3472209,75.3472209,74.6527791,74.6527791,74.3055582,73.9583313,73.6111104,75.3472209,75.6944418,69.7916687,75.3472209,73.2638896,77.0833313,76.0416687,75.6944418,75.3472209,76.0416687,67.0138896,75.,77.7777791,76.3888896,77.4305582,72.9166687,77.0833313,77.0833313,77.4305582,74.3055582,77.0833313,76.0416687,78.125,76.3888896,75.3472209,73.9583313,75.,74.6527791,75.3472209,72.9166687,76.0416687,76.3888896,75.3472209,75.6944418,77.7777791,77.4305582,74.6527791,75.,75.3472209,74.6527791,66.6666687,68.75,73.2638896,76.7361104,70.8333313,74.6527791,73.6111104,74.6527791,74.6527791,74.6527791,75.6944418,73.9583313,73.2638896,72.2222209,75.6944418,76.7361104,71.875,72.5694418,73.2638896,76.7361104,72.9166687,76.3888896,74.3055582,74.6527791,69.0972209,72.5694418,72.2222209,72.9166687,72.9166687,71.875,73.6111104,68.75,75.,76.3888896,73.2638896,72.2222209,72.5694418,74.6527791,73.2638896,72.9166687,72.2222209,67.0138896,75.3472209,72.9166687,70.4861104,72.5694418,71.1805582,71.5277791,71.1805582,72.2222209,78.125,68.0555582,77.4305582,72.9166687,73.2638896,73.2638896,71.5277791,71.875,71.5277791,70.4861104,71.875,75.6944418,66.6666687,72.2222209,65.9722209,73.2638896,75.,74.6527791,74.3055582,72.2222209,76.3888896,65.2777791,77.0833313,73.9583313,76.3888896,75.6944418,73.2638896,73.6111104,73.2638896,74.3055582,75.,78.4722209,71.1805582,74.3055582,70.4861104,73.2638896,73.6111104,73.9583313,74.6527791,71.5277791,70.1388896,74.3055582,73.9583313,76.7361104,68.4027791,75.,71.875,72.2222209,72.9166687,75.3472209,72.2222209,68.0555582,71.875,69.4444418,76.3888896,75.3472209,75.6944418,75.3472209,71.875,70.4861104,73.2638896,75.6944418,79.1666687,74.6527791,67.0138896,72.2222209,73.2638896,73.2638896,74.3055582,70.1388896,75.,63.5416687,72.2222209,70.8333313,72.9166687,73.6111104,71.875,74.6527791,71.5277791,71.5277791,75.6944418,70.4861104],
											borderColor: '#9bbb59',
											tension: 0.3,
											borderWidth: 4,
											radius: 0,
										},{
											label: 'val',
											data: [61.8055582,68.4027791,69.4444418,67.7083313,69.0972209,68.4027791,67.0138896,73.6111104,72.2222209,74.6527791,74.6527791,71.1805582,72.2222209,73.9583313,73.9583313,74.6527791,73.9583313,75.6944418,73.9583313,76.0416687,76.0416687,75.3472209,74.6527791,74.3055582,74.6527791,73.9583313,73.9583313,72.9166687,74.6527791,72.5694418,75.,75.,71.5277791,76.0416687,74.6527791,75.,73.2638896,73.9583313,72.2222209,70.8333313,70.4861104,69.7916687,70.8333313,71.875,71.5277791,72.2222209,72.5694418,73.2638896,70.1388896,70.8333313,75.6944418,76.3888896,72.9166687,72.2222209,71.875,72.2222209,72.9166687,73.2638896,68.75,72.9166687,71.5277791,74.6527791,72.2222209,72.2222209,72.5694418,71.1805582,70.1388896,70.8333313,70.8333313,69.7916687,74.3055582,60.7638896,73.6111104,70.8333313,71.1805582,72.2222209,71.5277791,71.875,66.6666687,69.0972209,66.3194418,73.9583313,70.1388896,70.1388896,71.5277791,70.8333313,71.5277791,69.7916687,73.2638896,73.9583313,73.2638896,71.5277791,68.4027791,72.2222209,70.8333313,70.4861104,72.2222209,69.4444418,71.5277791,69.7916687,60.4166687,72.2222209,74.3055582,70.4861104,69.7916687,72.2222209,70.4861104,69.7916687,73.6111104,70.4861104,72.2222209,72.2222209,68.0555582,73.9583313,67.0138896,69.0972209,71.5277791,70.4861104,70.4861104,67.3611104,73.9583313,72.2222209,70.8333313,69.7916687,70.1388896,69.7916687,69.4444418,72.2222209,70.1388896,70.8333313,71.5277791,69.7916687,70.8333313,64.5833313,68.75,69.4444418,69.7916687,69.0972209,70.8333313,66.6666687,68.4027791,65.625,69.4444418,70.4861104,68.0555582,69.0972209,68.4027791,69.4444418,68.0555582,67.0138896,74.6527791,72.5694418,72.9166687,72.5694418,70.1388896,69.7916687,68.0555582,69.4444418,62.1527791,69.0972209,67.0138896,65.2777791,66.3194418,69.4444418,68.4027791,67.0138896,65.625,63.1944418,70.4861104,63.5416687,61.1111104,66.6666687,64.5833313,69.4444418,67.0138896,68.4027791,67.3611104,68.75,70.8333313,66.3194418,75.,68.4027791,72.2222209,67.0138896,65.625,66.6666687,70.4861104,66.6666687,63.5416687,63.1944418,71.5277791,67.0138896,70.8333313,67.3611104,69.7916687,70.1388896,68.0555582,69.0972209,71.875,64.2361104],
											borderColor: '#8064a2',
											tension: 0.3,
											borderWidth: 4,
											radius: 0,
										},
									]
								},
								options: {
									responsive: true,
									interaction: {
										intersect: false
									},
									plugins: {
										title: {
											display: true,
											text: 'メタデータの有無によるResNet18でのacc'
										},
									},
									scales: {
										y: {
											min: 55,
											ticks: {
												callback: function(value, index, values) {
													return value.toString() + '%';
												}
											},
											grid: {
												color: 'grey'
											}
										},
										x: {
											type: 'linear',
											grid: {
												color: 'grey'
											}
										}
									}
								},
							});
						</script>
						<div class="text p-md-5">
							<p>ResNet18で学習を行った結果，メタデータを用いた場合の方がvalidationにおいて高精度であることが確認できます．また，メタデータだけでなく全結合層に隠れ層を追加して実験を行ったことで以下のことも確認できます．</p>
							<ul>
								<li>高精度</li>
								<ul>
									<li>畳み込み層の重みを変える</li>
									<li>隠れ層を追加</li>
								</ul>
								<li>過学習が軽減された</li>
							</ul>
						</div>
						<table class="table table-dark table-striped">
							<caption>ResNet18のAcc</caption>
							<thead>
								<tr>
								<th scope="col">conv層の重み</th>
								<th scope="col">メタデータ</th>
								<th scope="col">fc層</th>
								<th scope="col">accuracy</th>
								</tr>
							</thead>
							<tbody>
								<tr>
									<td>可変</td>
									<td colspan="2">無し</td>
									<td>76.39%</td>
								</tr>
								<tr>
									<td>固定</td>
									<td colspan="2">無し</td>
									<td>67.96%</td>
								</tr>
								<tr>
									<td>可変</td>
									<td>有り</td>
									<td>hidden層を追加</td>
									<td>79.17%</td>
								</tr>
								<tr>
									<td>固定</td>
									<td>有り</td>
									<td>hidden層を追加</td>
									<td>73.96%</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
				<h2 class="text-center ftco-animate" style="padding-top: 3rem;">EfficientNet-B1を用いた学習</h2>
				<div class="row py-5 ftco-animate">
					<div class="col-md-6 d-flex align-items-stretch">
						<div class="img w-100" style="background-image: url(../images/effb1.png);"></div>
					</div>
					<div class="col-md-6 my-auto">
						<canvas id="effb1" class="col-md-12" style="background-color: silver; height: 20rem; margin-top: 1rem;"></canvas>
						<script>
							var ctx = document.getElementById('effb1').getContext('2d');
							var chart = new Chart(ctx, {
								type: 'line',
								data: {
									labels: [...Array(200)].map((_, i) => i + 1),
									datasets: [
										{
											label: 'train_meta',
											data: [0.569711566,66.3461566,70.0721145,74.0384638,72.9567289,74.0384638,74.1586566,74.3990362,75.4807711,75.6009638,72.4759638,73.7980783,74.8798072,76.2019217,78.125,76.9230783,78.7259638,77.5240362,77.0432711,76.9230783,76.8028855,75.9615362,78.0048072,75.7211566,78.2451928,79.5673072,77.8846145,78.2451928,78.6057711,77.0432711,77.0432711,77.5240362,78.7259638,78.0048072,78.0048072,79.4471145,78.8461566,80.7692289,78.2451928,78.7259638,80.5288434,77.4038434,79.2067289,78.9663434,82.3317289,82.3317289,81.4903855,79.6875,80.8894217,80.4086566,79.4471145,80.5288434,80.4086566,80.6490362,81.7307711,81.7307711,83.0528855,83.7740362,78.9663434,82.5721145,83.8942289,81.25,79.3269217,82.4519217,83.2932711,83.5336566,83.0528855,83.1730783,82.8125,79.5673072,82.5721145,81.6105783,83.2932711,80.8894217,82.9326928,83.0528855,84.375,83.6538434,82.2115362,80.8894217,83.1730783,82.4519217,82.0913434,83.1730783,86.4182711,85.2163434,86.4182711,84.2548072,84.4951928,84.375,83.6538434,80.7692289,83.7740362,85.4567289,84.7355783,84.8557711,85.9375,85.9375,82.3317289,84.7355783,85.5769217,84.8557711,83.8942289,87.0192289,86.0576928,86.8990362,87.2596145,87.6201928,87.2596145,84.7355783,85.3365362,82.8125,85.0961566,88.1009638,85.9375,86.5384638,87.8605783,87.7403855,85.8173072,85.6971145,85.6971145,87.7403855,87.2596145,87.7403855,87.6201928,89.1826928,87.7403855,87.8605783,88.3413434,86.4182711,85.8173072,86.0576928,86.6586566,86.8990362,89.4230783,88.5817289,88.4615362,87.2596145,88.5817289,88.4615362,88.5817289,86.4182711,86.4182711,88.1009638,88.5817289,90.3846145,88.9423072,89.5432711,87.7403855,86.2980783,86.1778855,87.8605783,88.9423072,88.3413434,88.8221145,89.6634638,88.8221145,88.1009638,87.9807711,87.6201928,86.5384638,86.0576928,89.3028855,87.8605783,88.8221145,91.4663434,91.9471145,89.9038434,89.6634638,87.6201928,89.1826928,90.7451928,87.8605783,90.2644217,89.7836566,92.1875,89.9038434,89.0625,89.9038434,89.3028855,86.1778855,86.8990362,88.4615362,89.6634638,90.9855783,91.2259638,92.0673072,91.1057711,90.0240362,89.5432711,88.7019217,85.9375,91.1057711,89.7836566,91.9471145,91.7067289,93.1490362,90.8653855,90.9855783,90.7451928],
											borderColor: '#4f81bd',
											tension: 0.3,
											borderWidth: 4,
											radius: 0,
										},
										{
											label: 'train',
											data: [58.7740362,65.9855783,68.9903855,72.5961566,72.5961566,72.9567289,73.0769217,72.2355783,72.2355783,73.9182711,72.1153855,72.7163434,75.1201928,75.4807711,74.8798072,75.8413434,74.7596145,76.4423072,76.2019217,74.8798072,76.8028855,77.6442289,75.,75.8413434,76.2019217,76.5625,76.9230783,76.6826928,76.5625,78.2451928,75.2403855,75.4807711,76.5625,75.6009638,74.7596145,77.6442289,79.2067289,76.0817289,77.1634638,76.5625,76.2019217,77.7644217,79.4471145,76.9230783,75.8413434,79.0865362,78.7259638,77.8846145,77.7644217,76.4423072,77.5240362,78.6057711,79.6875,79.0865362,78.3653855,81.0096145,76.9230783,77.8846145,78.7259638,75.3605783,77.0432711,78.125,78.4855783,77.6442289,79.5673072,78.6057711,80.7692289,77.7644217,79.2067289,78.2451928,77.1634638,79.0865362,77.7644217,79.9278855,79.5673072,78.9663434,78.7259638,78.3653855,80.2884638,81.3701928,78.3653855,78.2451928,78.2451928,79.8076928,76.6826928,78.9663434,79.6875,79.0865362,80.2884638,78.2451928,78.3653855,79.6875,77.7644217,77.1634638,76.6826928,80.6490362,77.8846145,79.3269217,77.5240362,78.8461566,77.2836566,80.1682711,79.9278855,77.8846145,80.8894217,79.6875,78.9663434,80.2884638,80.5288434,80.2884638,76.9230783,80.2884638,78.7259638,79.2067289,79.8076928,81.4903855,80.1682711,78.125,80.0480783,78.3653855,80.0480783,76.8028855,77.5240362,79.2067289,78.2451928,80.2884638,78.6057711,78.6057711,78.8461566,79.3269217,79.2067289,80.1682711,80.0480783,81.4903855,80.5288434,80.5288434,81.0096145,79.0865362,81.4903855,76.5625,79.9278855,78.3653855,80.0480783,79.3269217,78.125,79.6875,79.5673072,80.2884638,81.0096145,80.6490362,78.3653855,79.5673072,78.6057711,79.9278855,79.3269217,78.8461566,80.2884638,79.6875,80.5288434,78.6057711,79.3269217,79.3269217,80.7692289,80.2884638,78.7259638,81.6105783,80.4086566,79.3269217,80.0480783,78.6057711,79.6875,79.4471145,79.8076928,79.5673072,79.5673072,80.0480783,81.7307711,80.6490362,77.1634638,81.0096145,78.9663434,79.9278855,78.7259638,80.2884638,81.1298072,80.7692289,79.8076928,80.2884638,79.2067289,79.5673072,78.125,81.0096145,81.0096145,81.4903855,79.0865362,79.9278855,81.0096145,81.6105783,80.1682711,79.4471145],
											borderColor: '#c0504d',
											tension: 0.1,
											borderWidth: 4,
											radius: 0,
										},
										{
											label: 'val_meta',
											data: [0.628472209,69.0972209,71.875,70.4861104,69.7916687,70.4861104,71.1805582,73.2638896,74.3055582,74.6527791,72.9166687,76.3888896,74.6527791,75.3472209,75.3472209,73.6111104,75.,76.7361104,69.0972209,74.6527791,71.5277791,73.6111104,72.5694418,73.2638896,72.5694418,71.5277791,70.1388896,70.4861104,69.7916687,65.2777791,66.6666687,67.0138896,67.0138896,69.0972209,68.4027791,68.4027791,70.1388896,67.3611104,69.4444418,66.3194418,68.75,68.4027791,62.8472209,66.3194418,65.625,65.9722209,65.9722209,62.5,68.0555582,67.0138896,68.0555582,62.8472209,65.9722209,65.9722209,67.0138896,66.6666687,66.3194418,69.4444418,68.0555582,69.7916687,69.7916687,67.7083313,67.3611104,70.4861104,68.75,67.3611104,68.4027791,69.7916687,68.4027791,69.4444418,62.8472209,65.9722209,69.4444418,69.0972209,68.0555582,68.75,68.75,67.0138896,67.7083313,64.5833313,69.0972209,66.6666687,67.3611104,67.7083313,68.0555582,68.0555582,67.0138896,66.3194418,65.625,67.0138896,72.2222209,71.5277791,65.625,66.6666687,67.0138896,65.9722209,66.6666687,66.6666687,69.0972209,63.5416687,64.5833313,69.7916687,67.3611104,66.3194418,68.0555582,68.0555582,68.0555582,67.0138896,64.2361104,70.1388896,70.8333313,67.3611104,67.7083313,65.2777791,68.4027791,67.7083313,68.0555582,71.875,69.7916687,66.6666687,68.75,69.4444418,67.7083313,65.9722209,65.9722209,65.625,68.4027791,71.5277791,69.0972209,69.7916687,69.4444418,68.4027791,65.2777791,63.8888896,64.9305582,65.2777791,65.9722209,67.3611104,67.3611104,68.0555582,65.2777791,65.625,63.8888896,67.3611104,67.0138896,66.3194418,65.625,65.625,69.0972209,67.0138896,70.4861104,64.5833313,70.4861104,67.3611104,66.6666687,66.3194418,66.3194418,65.2777791,65.625,70.1388896,56.9444418,65.625,67.7083313,70.1388896,69.4444418,68.75,68.4027791,70.4861104,68.75,71.5277791,68.75,67.7083313,69.4444418,68.4027791,67.7083313,68.4027791,67.0138896,67.0138896,64.5833313,65.2777791,69.4444418,67.3611104,65.625,68.75,68.4027791,67.7083313,67.0138896,69.4444418,67.0138896,65.2777791,66.3194418,67.3611104,67.3611104,68.0555582,66.3194418,66.3194418,67.3611104,67.7083313,67.0138896,68.0555582],
											borderColor: '#9bbb59',
											tension: 0.3,
											borderWidth: 4,
											radius: 0,
										},{
											label: 'val',
											data: [0.552083313,72.5694418,68.4027791,70.4861104,70.8333313,71.1805582,71.1805582,70.1388896,69.4444418,70.1388896,69.7916687,67.0138896,67.3611104,67.7083313,68.0555582,67.7083313,67.0138896,67.7083313,69.7916687,68.75,70.8333313,69.7916687,69.4444418,69.4444418,68.4027791,69.0972209,68.75,69.0972209,70.1388896,69.7916687,66.3194418,70.4861104,71.5277791,71.875,70.8333313,70.1388896,71.1805582,71.5277791,69.7916687,71.875,70.8333313,69.7916687,68.0555582,72.9166687,72.9166687,72.5694418,72.5694418,71.1805582,73.2638896,70.4861104,72.2222209,69.7916687,71.5277791,72.9166687,71.875,71.875,72.2222209,71.1805582,72.5694418,70.8333313,71.1805582,70.4861104,69.4444418,70.4861104,71.5277791,71.1805582,71.5277791,70.8333313,72.2222209,71.5277791,69.7916687,70.4861104,70.4861104,69.4444418,69.4444418,69.4444418,69.4444418,69.7916687,71.5277791,71.875,71.5277791,71.1805582,71.1805582,72.2222209,72.2222209,71.875,72.2222209,71.1805582,70.8333313,71.1805582,69.0972209,69.7916687,70.4861104,70.8333313,70.4861104,70.4861104,70.8333313,70.8333313,69.7916687,70.1388896,69.0972209,68.75,69.0972209,69.4444418,69.4444418,69.0972209,68.75,67.7083313,68.0555582,67.7083313,67.0138896,69.0972209,68.0555582,68.4027791,68.0555582,67.7083313,67.7083313,69.0972209,67.7083313,68.0555582,69.7916687,68.0555582,68.75,68.75,68.75,67.7083313,68.0555582,68.4027791,68.75,68.4027791,68.0555582,68.4027791,69.0972209,69.0972209,68.75,68.4027791,68.75,68.75,68.0555582,68.4027791,70.8333313,67.7083313,69.4444418,68.0555582,68.75,68.75,68.0555582,68.4027791,67.0138896,69.0972209,67.7083313,67.0138896,68.75,67.7083313,67.7083313,67.7083313,67.3611104,66.6666687,69.7916687,67.3611104,68.0555582,68.0555582,68.75,69.0972209,69.0972209,69.0972209,68.4027791,69.7916687,70.1388896,68.75,69.0972209,68.4027791,67.0138896,68.0555582,69.0972209,69.0972209,69.0972209,68.4027791,68.75,68.75,67.7083313,68.4027791,68.4027791,68.75,67.7083313,67.3611104,68.0555582,68.4027791,68.75,70.1388896,68.75,69.4444418,69.4444418,68.0555582,68.75,68.4027791,68.4027791,69.4444418,70.1388896,69.7916687],
											borderColor: '#8064a2',
											tension: 0.3,
											borderWidth: 4,
											radius: 0,
										},
									]
								},
								options: {
									responsive: true,
									interaction: {
										intersect: false
									},
									plugins: {
	
										title: {
											display: true,
											text: 'メタデータの有無によるEfficientNet-B1でのacc'
										},
									},
									scales: {
										y: {
											min: 60,
											ticks: {
												callback: function(value, index, values) {
													return value.toString() + '%';
												}
											},
											grid: {
												color: 'grey'
											}
										},
										x: {
											type: 'linear',
											grid: {
												color: 'grey'
											}
										}
									}
								},
							});
						</script>
						<div class="text p-md-5">
							<p>EfficientNet-B1で学習を行った結果，メタデータを用いた場合の方がvalidationにおいて高精度であることが確認できます．また，メタデータだけでなく全結合層に隠れ層を追加して実験を行ったことで以下のことが確認できます．</p>
							<ul>
								<li>高精度
									<ul>
										<li>メタデータの追加</li>
										<li>隠れ層の追加</li>
									</ul>
								</li>
								<li>ResNetよりも学習の収束が早い</li>
							</ul>
						</div>
						<table class="table table-dark table-striped">
							<caption>EfficientNet-B1のAcc</caption>
							<thead>
								<tr>
								<th scope="col">conv層の重み</th>
								<th scope="col">メタデータ</th>
								<th scope="col">fc層</th>
								<th scope="col">accuracy</th>
								</tr>
							</thead>
							<tbody>
								<tr>
									<td>可変</td>
									<td colspan="2">無し</td>
									<td>70.83%</td>
								</tr>
								<tr>
									<td>固定</td>
									<td colspan="2">無し</td>
									<td>73.26%</td>
								</tr>
								<tr>
									<td>可変</td>
									<td>有り</td>
									<td>hidden層を追加</td>
									<td>76.74%</td>
								</tr>
								<tr>
									<td>固定</td>
									<td>有り</td>
									<td>hidden層を追加</td>
									<td>75.00%</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
				<h2 class="text-center ftco-animate" style="padding-top: 3rem;">まとめ</h2>
				<div class="row py-5 ftco-animate">
					<div class="col-md-6">
						<canvas id="compare" style="height: 15rem; background-color: silver;"></canvas>
						<script>
							var ctx = document.getElementById('compare').getContext('2d');
							var chart = new Chart(ctx, {
								type: 'bar',
								data: {
									labels: ['ResNet18', 'EfficientNet-B1'],
									datasets: [
										{
											label: 'only image',
											data: [71.03, 70.83],
											backgroundColor: ['#b83d68']
										},
										{
											label: 'add metadata',
											data: [73.96, 73.26],
											backgroundColor: ['#ac66bb']
										},
										{
											label: 'add hidden',
											data: [79.16, 76.74],
											backgroundColor: ['#de6c36']
										},
										{
											label: 'Doctor',
											data: [74, 74],
											backgroundColor: ['#f9b639']
										}
									]
								},
								options: {
									responsive: true,
									maintainAspectRatio: false,

									plugins: {
										legend: {
											position: 'top',
										},
										title: {
											display: true,
											text: 'Accの比較'
										},
									},
									scales: {
										y: {
											min: 70,
											ticks: {
												callback: function(value, index, values) {
													return value.toString() + '%';
												}
											},
											grid: {
												color: 'grey'
											}
										},
										x: {
											grid: {
												color: 'grey'
											}
										}
									}
								}
							});
						</script>
					</div>
					<div class="col-md-6 p-md-5">
						<p>今回の研究で，ResNet18とEfficientNet-B1の双方で医者の平均識別率を超えることができました．しかし，80%程度では実用性はないので，更なる改善が必要であると考えます．具体的にはCNN以外に</p>
						<ul>
							<li>Vision Transformer</li>
							<li>Attention</li>
						</ul>
						<p>の様な畳み込み処理のない手法を使用し，細部における情報の欠損をさせることのない学習をさせていきたいと思っています．</p>
					</div>
				</div>
			</div>
		</section>
		<!-- End Main Section -->
		<!-- Start Footer Section -->
		<footer class="ftco-footer py-5">
			<div class="container text-center">
				<div class="row">
					<div class="col-md-12 text-center">
						<p>
							&copy;<script>document.write(new Date().getFullYear());</script> All rights reserved by a5chin
						</p>
						<ul class="ftco-footer-social p-0">
							<li class="ftco-animate"><a href="https://a5chin.github.io/portfolio/"><span class="icon-home"></span></a></li>
							<li class="ftco-animate"><a href="https://github.com/a5chin"><span class="icon-github"></span></a></li>
							<li class="ftco-animate"><a href="https://a5chin.github.io/portfolio/"><span class="icon-twitter"></span></a></li>
						</ul>
					</div>
				</div>
			</div>
		</footer>
		<!-- End Footer Section -->

    	<!-- loader -->
		<div id="ftco-loader" class="show fullscreen"><svg class="circular" width="48px" height="48px"><circle class="path-bg" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke="#eeeeee"/><circle class="path" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke-miterlimit="10" stroke="#F96D00"/></svg></div>

		<script src="../js/jquery.min.js"></script>
		<script src="../js/jquery-migrate-3.0.1.min.js"></script>
		<script src="../js/jquery.waypoints.min.js"></script>
		<script src="../js/jquery.stellar.min.js"></script>
		<script src="../js/owl.carousel.min.js"></script>
		<script src="../js/aos.js"></script>
		<script src="../js/scrollax.min.js"></script>
		<script src="../js/main.js"></script>
  	</body>
</html>